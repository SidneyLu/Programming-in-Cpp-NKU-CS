# 南开大学 高级语言程序设计 Lecture 3


## 一、array：固定大小的高效容器
### 1. 核心特性
C++11新增的array，在C数组基础上封装，无额外运行开销：
- **固定大小**：编译时确定大小，不可修改；
- **静态存储**：元素存于栈或静态区，分配快；
- **安全访问**：`at()`方法做边界检查（越界抛异常），`[]`无检查（快速）；
- **兼容算法**：支持迭代器与范围for循环，可直接用STL算法。

### 2. 关键功能与场景
- 常用功能：`size()`（固定大小）、`fill()`（批量填充）、`swap()`（同类型同大小容器交换）、`data()`（获取底层数组指针，兼容C接口）；
- 适用场景：固定长度数据（如RGB值、月份天数）、性能敏感代码、需避免数组退化的参数传递。


## 二、vector：动态灵活的动态数组
### 1. 核心特性
STL最常用容器，封装动态数组：
- **动态大小**：运行时可增删元素，自动管理内存；
- **连续存储**：支持O(1)随机访问，尾部操作（`push_back`/`pop_back`）均摊O(1)；
- **扩容机制**：容量不足时，分配原容量1.5~2倍新空间（编译器差异），拷贝旧元素后释放旧空间；
- **迭代器风险**：扩容或中间插入/删除时，迭代器可能失效（需重新获取）。

### 2. 关键功能与场景
- 常用功能：`reserve()`（预分配容量，减少扩容）、`emplace_back()`（直接构造元素，比`push_back`高效）、`insert()`/`erase()`（中间操作，O(n)复杂度）、`shrink_to_fit()`（收缩容量匹配大小）；
- 适用场景：元素数量不确定（如用户输入）、需频繁尾部操作、需与C接口交互（`data()`获取指针）。


## 三、核心差异与选择建议
| 特性         | array                | vector                |
|--------------|----------------------|-----------------------|
| 内存分配     | 栈/静态区            | 堆                    |
| 大小         | 编译时固定           | 运行时动态调整        |
| 访问效率     | 极高（接近C数组）    | 高（连续存储）        |
| 插入删除     | 不支持动态操作       | 尾部快，中间慢        |
| 迭代器安全   | 不失效（除销毁）     | 扩容/中间操作易失效   |

### 最佳实践
- **用array**：替代C数组提升安全性；固定大小、性能敏感场景优先；
- **用vector**：预分配`reserve()`减少扩容；优先`emplace_back`；避免传值（用引用），注意迭代器失效；

